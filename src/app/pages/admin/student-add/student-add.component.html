<div class="dashboard-main-body">
  <app-breadcrumb [title]="title"></app-breadcrumb>

  <div class="card h-100 p-0 radius-12">
    <div class="card-header border-bottom bg-base py-16 px-24">
      <form #StudentForm="ngForm" (ngSubmit)="onSubmit(StudentForm)" novalidate class="Student-form">

        <!-- Section ① – Basic Info -->
        <div class="form-section mb-4">
          <h5 class="section-title fw-semibold mb-2">
            <span class="number">①</span> Basic Info
          </h5>
          <hr />

          <div class="row g-3 p-12">

            <!-- Student Name -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Student Name <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control radius-8" name="studentName" placeholder="Enter Student Name"
                [(ngModel)]="newStudent.studentName" #studentName="ngModel" required
                [ngClass]="{ 'is-invalid': studentName.invalid && studentName.touched }" />
              <small *ngIf="studentName.invalid && studentName.touched" class="text-danger">
                This field is required
              </small>
            </div>

            <!-- Gender -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Gender <span class="text-danger">*</span>
              </label>
              <select class="form-control radius-8 form-select" name="studentGender"
                [(ngModel)]="newStudent.studentGender" #studentGender="ngModel" required
                [ngClass]="{ 'is-invalid': studentGender.invalid && studentGender.touched }">
                <option value="">Select Gender</option>
                <option [value]="GenderList.Male">Male</option>
                <option [value]="GenderList.Female">Female</option>
                <option [value]="GenderList.Other">Other</option>
              </select>
              <small *ngIf="studentGender.invalid && studentGender.touched" class="text-danger">
                This field is required
              </small>
            </div>

            <!-- Date of Birth -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Date of Birth <span class="text-danger">*</span>
              </label>
              <input type="date" class="form-control radius-8" name="studentDOB" [(ngModel)]="studentDOBStr"
                #studentDOB="ngModel" required [ngClass]="{ 'is-invalid': studentDOB.invalid && studentDOB.touched }" />
              <small *ngIf="studentDOB.invalid && studentDOB.touched" class="text-danger">
                This field is required
              </small>
            </div>

            <!-- Class -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Class <span class="text-danger">*</span>
              </label>
              <select class="form-control radius-8 form-select" name="class" [(ngModel)]="newStudent.standardId"
                #standardId="ngModel" required [ngClass]="{ 'is-invalid': standardId.invalid && standardId.touched }">
                <option [ngValue]="null">Select Class</option>
                <option *ngFor="let c of classes" [ngValue]="c.standardId">{{ c.standardName }}</option>
              </select>
              <small *ngIf="standardId.invalid && standardId.touched" class="text-danger">
                This field is required
              </small>
            </div>

            <!-- Section -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Section <span class="text-danger">*</span>
              </label>
              <select class="form-control radius-8 form-select" name="section" [(ngModel)]="newStudent.section"
                #section="ngModel" required [ngClass]="{ 'is-invalid': section.invalid && section.touched }">
                <option value="">Select Section</option>
                <option value="A">Section A</option>
                <option value="B">Section B</option>
                <option value="C">Section C</option>
                <option value="D">Section D</option>
              </select>
              <small *ngIf="section.invalid && section.touched" class="text-danger">
                This field is required
              </small>
            </div>

            <!-- Profile Picture -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">Profile Picture</label>
              <input type="file" class="form-control radius-8" id="imageUpload" (change)="onImageSelected($event)"
                accept=".png, .jpg, .jpeg" />
            </div>
          </div>
        </div>

        <!-- Section ② – Academic Info -->
        <div class="form-section mb-4">
          <h5 class="section-title fw-semibold mb-2">
            <span class="number">②</span> Academic Info
          </h5>
          <hr />
          <div class="row g-3 p-12">

            <!-- Admission Date -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Admission Date <span class="text-danger">*</span>
              </label>
              <input type="date" class="form-control radius-8" name="admissionDate" [(ngModel)]="admissionDateStr"
                #admissionDate="ngModel" required
                [ngClass]="{ 'is-invalid': admissionDate.invalid && admissionDate.touched }" />
              <small *ngIf="admissionDate.invalid && admissionDate.touched" class="text-danger">
                This field is required
              </small>
            </div>

            <!-- Previous School -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">Previous School</label>
              <input type="text" class="form-control radius-8" name="previousSchool"
                placeholder="Enter Previous School Name" [(ngModel)]="newStudent.previousSchool"
                #previousSchool="ngModel" />
            </div>

            <!-- Status -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Status <span class="text-danger">*</span>
              </label>
              <select class="form-control radius-8 form-select" name="status" [(ngModel)]="newStudent.status"
                #status="ngModel" required [ngClass]="{ 'is-invalid': status.invalid && status.touched }">
                <option value="">Select Status</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
              </select>
              <small *ngIf="status.invalid && status.touched" class="text-danger">
                This field is required
              </small>
            </div>

          </div>
        </div>

        <!-- Section ③ – Contact Info -->
        <div class="form-section mb-4">
          <h5 class="section-title fw-semibold mb-2">
            <span class="number">③</span> Contact Info
          </h5>
          <hr />
          <div class="row g-3 p-12">

            <!-- Phone -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Phone <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control radius-8" name="studentContactNumber1" placeholder="0300-1234567"
                [(ngModel)]="newStudent.studentContactNumber1" pattern="^03\d{2}-\d{7}$"
                #studentContactNumber1="ngModel" required
                [ngClass]="{ 'is-invalid': studentContactNumber1.invalid && studentContactNumber1.touched }" />
              <small *ngIf="studentContactNumber1.errors?.['required'] && studentContactNumber1.touched"
                class="text-danger">
                This field is required
              </small>
              <small *ngIf="studentContactNumber1.errors?.['pattern'] && studentContactNumber1.touched"
                class="text-danger">
                Invalid format
              </small>
            </div>

            <!-- Guardian Name -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Guardian Name <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control radius-8" name="guardianName" placeholder="Enter Guardian Name"
                [(ngModel)]="newStudent.fatherName" #guardianName="ngModel" required
                [ngClass]="{ 'is-invalid': guardianName.invalid && guardianName.touched }" />
              <small *ngIf="guardianName.invalid && guardianName.touched" class="text-danger">
                This field is required
              </small>
            </div>

            <!-- Guardian Phone -->
            <div class="col-12 col-sm-6 col-md-4">
              <label class="form-label">
                Guardian Phone <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control radius-8" name="guardianPhone" placeholder="0300-1234567"
                [(ngModel)]="newStudent.guardianPhone" pattern="^03\d{2}-\d{7}$" #guardianPhone="ngModel" required
                [ngClass]="{ 'is-invalid': guardianPhone.invalid && guardianPhone.touched }" />
              <small *ngIf="guardianPhone.errors?.['required'] && guardianPhone.touched" class="text-danger">
                This field is required
              </small>
              <small *ngIf="guardianPhone.errors?.['pattern'] && guardianPhone.touched" class="text-danger">
                Invalid format
              </small>
            </div>

            <!-- Address -->
            <div class="col-12">
              <label class="form-label">
                Address <span class="text-danger">*</span>
              </label>
              <textarea class="form-control radius-8" rows="3" name="permanentAddress"
                placeholder="Enter complete permanentAddress" [(ngModel)]="newStudent.permanentAddress"
                #permanentAddress="ngModel" required
                [ngClass]="{ 'is-invalid': permanentAddress.invalid && permanentAddress.touched }"></textarea>
              <small *ngIf="permanentAddress.invalid && permanentAddress.touched" class="text-danger">
                This field is required
              </small>
            </div>

          </div>
        </div>

        <!-- Submit & Cancel -->
        <div class="d-flex align-items-center justify-content-center gap-3 mt-4">
          <button type="button" (click)="cancel()"
            class="border border-danger-600 bg-hover-danger-200 text-danger-600 text-md px-56 py-11 radius-8">
            Cancel
          </button>

          <button type="submit" class="btn btn-primary border border-primary-600 text-md px-56 py-12 radius-8">
            Save
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Validation Modal -->
  <div class="modal fade" id="validationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content radius-12 p-3">
        <div class="modal-header border-0">
          <h5 class="modal-title text-danger fw-semibold">Form Incomplete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center">
          Please fill in all required fields (marked with *)
        </div>
        <div class="modal-footer border-0 justify-content-center">
          <button type="button" class="btn btn-primary px-4" data-bs-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content radius-12 p-3">
        <div class="modal-header border-0">
          <h5 class="modal-title text-success fw-semibold">Success!</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center">
          Student added successfully!
        </div>
        <div class="modal-footer border-0 justify-content-center">
          <button type="button" class="btn btn-success px-4" data-bs-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>
</div>