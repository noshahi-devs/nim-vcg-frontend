<!-- <div class="dashboard-main-body">
  <app-breadcrumb [title]="title"></app-breadcrumb>

  <div class="card radius-12 mb-24">
    <div class="card-body p-24">
      <div class="row gy-3">
        <div class="col-md-3">
          <label class="form-label">Select Exam <span class="text-danger">*</span></label>
          <select class="form-select" [(ngModel)]="selectedExamId" (change)="onFilterChange()">
            <option [value]="0">Select Exam</option>
            <option *ngFor="let exam of exams" [value]="exam.examId">{{ exam.examName }}</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label">Select Class <span class="text-danger">*</span></label>
          <select class="form-select" [(ngModel)]="selectedClassId">
            <option [value]="0">Select Class</option>
            <option *ngFor="let cls of classes" [value]="cls.id">{{ cls.name }}</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label">Select Section <span class="text-danger">*</span></label>
          <select class="form-select" [(ngModel)]="selectedSectionId">
            <option [value]="0">Select Section</option>
            <option *ngFor="let sec of sections" [value]="sec.id">{{ sec.name }}</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label">Select Subject <span class="text-danger">*</span></label>
          <select class="form-select" [(ngModel)]="selectedSubjectId" (change)="onFilterChange()">
            <option [value]="0">Select Subject</option>
            <option *ngFor="let subject of subjects" [value]="subject.id">{{ subject.name }}</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <div class="card radius-12 mb-24">
    <div class="card-body p-24">
      <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">
        <div class="d-flex align-items-center gap-3 flex-wrap">
          <button type="button" (click)="saveMarks()" 
                  class="btn btn-primary-600 radius-8 px-20 py-11 d-flex align-items-center gap-2"
                  [disabled]="studentMarks.length === 0">
            <iconify-icon icon="material-symbols:save" class="text-xl"></iconify-icon>
            Save Marks
          </button>
          
          <button type="button" (click)="publishResults()" 
                  class="btn btn-success-600 radius-8 px-20 py-11 d-flex align-items-center gap-2"
                  [disabled]="studentMarks.length === 0">
            <iconify-icon icon="material-symbols:publish" class="text-xl"></iconify-icon>
            Publish Result
          </button>

          <button type="button" (click)="importExcel()" 
                  class="btn btn-info-600 radius-8 px-20 py-11 d-flex align-items-center gap-2">
            <iconify-icon icon="material-symbols:upload-file" class="text-xl"></iconify-icon>
            Import Excel
          </button>

          <button type="button" (click)="exportExcel()" 
                  class="btn btn-outline-primary-600 radius-8 px-20 py-11 d-flex align-items-center gap-2"
                  [disabled]="studentMarks.length === 0">
            <iconify-icon icon="material-symbols:download" class="text-xl"></iconify-icon>
            Export Excel
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="card h-100 p-0 radius-12">
    <div class="card-header border-bottom bg-base py-16 px-24">
      <h6 class="text-lg fw-semibold mb-0">Student Marks Entry</h6>
    </div>

    <div class="card-body p-24">
      <div *ngIf="loading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>

      <div *ngIf="!loading && studentMarks.length === 0" class="text-center py-5">
        <iconify-icon icon="mdi:information-outline" class="text-secondary-light" style="font-size: 48px;"></iconify-icon>
        <p class="text-secondary-light mt-3 mb-0">Please select Exam and Subject to load students</p>
      </div>

      <div *ngIf="!loading && studentMarks.length > 0" class="table-responsive scroll-sm">
        <table class="table bordered-table sm-table mb-0">
          <thead>
            <tr>
              <th scope="col" style="width: 80px;">Roll No</th>
              <th scope="col">Student Name</th>
              <th scope="col" style="width: 120px;">Total Marks</th>
              <th scope="col" style="width: 150px;">Obtained Marks</th>
              <th scope="col" style="width: 120px;">Percentage</th>
              <th scope="col" style="width: 100px;">Grade</th>
              <th scope="col" style="width: 200px;">Remarks</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let student of studentMarks; let i = index">
              <td>
                <span class="fw-semibold">{{ student.rollNo }}</span>
              </td>
              <td>
                <span class="text-primary-600">{{ student.studentName }}</span>
              </td>
              <td>
                <input type="number" 
                       class="form-control form-control-sm" 
                       [(ngModel)]="student.totalMarks"
                       (ngModelChange)="calculateGradeAndPercentage(student)"
                       min="0" />
              </td>
              <td>
                <input type="number" 
                       class="form-control form-control-sm" 
                       [(ngModel)]="student.obtainedMarks"
                       (ngModelChange)="onObtainedMarksChange(student)"
                       [max]="student.totalMarks"
                       min="0" />
              </td>
              <td class="text-center">
                <span class="fw-semibold">{{ student.percentage || 0 }}%</span>
              </td>
              <td class="text-center">
                <span *ngIf="student.grade" 
                      class="px-12 py-4 radius-4 fw-medium text-sm"
                      [ngClass]="getGradeBadgeClass(student.grade)">
                  {{ student.grade }}
                </span>
                <span *ngIf="!student.grade" class="text-secondary-light">-</span>
              </td>
              <td>
                <input type="text" 
                       class="form-control form-control-sm" 
                       [(ngModel)]="student.remarks"
                       placeholder="Optional remarks" />
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="studentMarks.length > 0" class="mt-24 p-16 bg-neutral-50 radius-8">
        <h6 class="text-md fw-semibold mb-3">Grading Scale</h6>
        <div class="row gy-2">
          <div class="col-md-2">
            <span class="badge bg-success-focus text-success-600 border border-success-main px-12 py-4 fw-medium">A+ (90-100%)</span>
          </div>
          <div class="col-md-2">
            <span class="badge bg-success-focus text-success-600 border border-success-main px-12 py-4 fw-medium">A (80-89%)</span>
          </div>
          <div class="col-md-2">
            <span class="badge bg-info-focus text-info-600 border border-info-main px-12 py-4 fw-medium">B (70-79%)</span>
          </div>
          <div class="col-md-2">
            <span class="badge bg-warning-focus text-warning-600 border border-warning-main px-12 py-4 fw-medium">C (60-69%)</span>
          </div>
          <div class="col-md-2">
            <span class="badge bg-orange-focus text-orange-600 border border-orange-main px-12 py-4 fw-medium">D (50-59%)</span>
          </div>
          <div class="col-md-2">
            <span class="badge bg-danger-focus text-danger-600 border border-danger-main px-12 py-4 fw-medium">F (<50%)</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> -->