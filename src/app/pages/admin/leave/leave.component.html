<div class="dashboard-main-body">
  <app-breadcrumb [title]="title"></app-breadcrumb>

  <!-- Premium Stats Cards -->
  <div class="row gy-4 mb-30 mt-2">
    <div class="col-xxl-3 col-sm-6">
      <div class="premium-dashboard-card">
        <div class="d-flex align-items-center justify-content-between mb-20">
          <div class="icon-box-premium" style="background: rgba(128, 0, 32, 0.1); color: #800020;">
            <iconify-icon icon="solar:document-text-bold-duotone"></iconify-icon>
          </div>
          <span class="badge radius-pill px-15 py-6 fw-black"
            style="background: rgba(128, 0, 32, 0.05); color: #800020; font-size: 0.65rem;">TOTAL ENTRIES</span>
        </div>
        <span class="text-secondary-light fw-bold text-uppercase letter-spacing-1 small d-block mb-5">Aggregate
          Requests</span>
        <h1 class="fw-black mb-0" style="color: #800020; font-size: 2.5rem;">{{ totalLeavesCount }}</h1>
      </div>
    </div>

    <div class="col-xxl-3 col-sm-6">
      <div class="premium-dashboard-card">
        <div class="d-flex align-items-center justify-content-between mb-20">
          <div class="icon-box-premium" style="background: rgba(245, 158, 11, 0.1); color: #d97706;">
            <iconify-icon icon="solar:clock-circle-bold-duotone"></iconify-icon>
          </div>
          <span class="badge radius-pill px-15 py-6 fw-black"
            style="background: rgba(245, 158, 11, 0.05); color: #d97706; font-size: 0.65rem;">IN QUEUE</span>
        </div>
        <span class="text-secondary-light fw-bold text-uppercase letter-spacing-1 small d-block mb-5">Pending
          Decisions</span>
        <h1 class="fw-black mb-0" style="color: #d97706; font-size: 2.5rem;">{{ pendingLeavesCount }}</h1>
      </div>
    </div>

    <div class="col-xxl-3 col-sm-6">
      <div class="premium-dashboard-card">
        <div class="d-flex align-items-center justify-content-between mb-20">
          <div class="icon-box-premium" style="background: rgba(34, 197, 94, 0.1); color: #16a34a;">
            <iconify-icon icon="solar:check-circle-bold-duotone"></iconify-icon>
          </div>
          <span class="badge radius-pill px-15 py-6 fw-black"
            style="background: rgba(34, 197, 94, 0.05); color: #16a34a; font-size: 0.65rem;">AUTHORIZED</span>
        </div>
        <span class="text-secondary-light fw-bold text-uppercase letter-spacing-1 small d-block mb-5">Approved
          Manifests</span>
        <h1 class="fw-black mb-0" style="color: #16a34a; font-size: 2.5rem;">{{ approvedLeavesCount }}</h1>
      </div>
    </div>

    <div class="col-xxl-3 col-sm-6">
      <div class="premium-dashboard-card">
        <div class="d-flex align-items-center justify-content-between mb-20">
          <div class="icon-box-premium" style="background: rgba(239, 68, 68, 0.1); color: #dc2626;">
            <iconify-icon icon="solar:close-circle-bold-duotone"></iconify-icon>
          </div>
          <span class="badge radius-pill px-15 py-6 fw-black"
            style="background: rgba(239, 68, 68, 0.05); color: #dc2626; font-size: 0.65rem;">DECLINED</span>
        </div>
        <span class="text-secondary-light fw-bold text-uppercase letter-spacing-1 small d-block mb-5">Rejected
          Applications</span>
        <h1 class="fw-black mb-0" style="color: #dc2626; font-size: 2.5rem;">{{ rejectedLeavesCount }}</h1>
      </div>
    </div>
  </div>

  <!-- Recent Leave Applications Master Table -->
  <div class="master-table-card">
    <div class="master-table-header">
      <div>
        <h6>Attendance & Leave Registry</h6>
        <p class="mb-0 text-white-50 small fw-bold text-uppercase letter-spacing-1">Activity Stream Manifest</p>
      </div>
      <div class="d-flex align-items-center gap-3">
        <button type="button" (click)="refreshData()" class="premium-action-btn">
          <iconify-icon icon="solar:refresh-linear" class="text-xl"></iconify-icon>Sync Data
        </button>
        <button type="button" (click)="exportData()" class="premium-action-btn"
          style="background: rgba(255,255,255,0.1)">
          <iconify-icon icon="solar:cloud-download-linear" class="text-xl"></iconify-icon>Report
        </button>
      </div>
    </div>

    <div class="p-0">
      <div class="table-responsive">
        <table class="table premium-dashboard-table">
          <thead>
            <tr>
              <th><span class="ps-15">S.L</span></th>
              <th>Employee Profile</th>
              <th>Category</th>
              <th>Duration Period</th>
              <th class="text-center">Current Status</th>
              <th class="text-center">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let leave of paginatedApplications; let i = index">
              <td><span class="ps-15 fw-black text-secondary-light">{{ (currentPage - 1) * rowsPerPage + i + 1 }}</span>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <div
                    class="w-44-px h-44-px rounded-14 d-flex justify-content-center align-items-center bg-primary-50 text-primary-600 fw-black shadow-sm me-15 border">
                    {{ (leave.staff?.staffName || '?').charAt(0) }}
                  </div>
                  <div>
                    <span class="fw-bold text-dark d-block lead mb-0" style="font-size: 1rem;">{{ leave.staff?.staffName
                      || 'N/A' }}</span>
                    <small class="text-muted fw-bold text-uppercase" style="font-size: 0.65rem;">{{
                      leave.staff?.designation || 'Staff Member' }}</small>
                  </div>
                </div>
              </td>
              <td>
                <span class="badge radius-8 px-15 py-8 fw-black"
                  style="background: rgba(128, 0, 32, 0.05); color: #800020; border: 1px solid rgba(128, 0, 32, 0.1);">
                  {{ getLeaveTypeName(leave.leaveType) }}
                </span>
              </td>
              <td class="fw-medium text-dark">
                <div class="d-flex align-items-center">
                  <iconify-icon icon="solar:calendar-linear" class="me-8 text-primary-200"></iconify-icon>
                  {{ leave.startDate | date:'dd MMM yyyy' }} <span class="mx-8 text-muted">â†’</span> {{ leave.endDate |
                  date:'dd MMM yyyy' }}
                </div>
              </td>
              <td class="text-center">
                <span class="status-pill" [ngClass]="{
                  'pill-pending': leave.status === 0,
                  'pill-approved': leave.status === 1,
                  'pill-rejected': leave.status === 2
                }">
                  <iconify-icon
                    [icon]="leave.status === 0 ? 'solar:reorder-bold' : (leave.status === 1 ? 'solar:verified-check-bold' : 'solar:shield-cross-bold')"
                    class="me-5"></iconify-icon>
                  {{ getLeaveStatusName(leave.status) }}
                </span>
              </td>
              <td class="text-center">
                <button type="button" (click)="viewDetails(leave)" class="view-btn-premium" title="Detailed Inspection">
                  <iconify-icon icon="solar:magnifer-linear" class="text-xl"></iconify-icon>
                </button>
              </td>
            </tr>
            <tr *ngIf="paginatedApplications.length === 0 && !loading">
              <td colspan="6" class="text-center py-100">
                <div class="d-flex flex-column align-items-center justify-content-center">
                  <iconify-icon icon="solar:folder-error-linear" class="text-primary-100 mb-20"
                    style="font-size: 6rem;"></iconify-icon>
                  <h3 class="fw-black text-secondary-light">Registry Empty</h3>
                  <p class="text-muted lead">No archaeological leave records found in the current temporal frame</p>
                </div>
              </td>
            </tr>
            <tr *ngIf="loading">
              <td colspan="6" class="text-center py-60">
                <div class="spinner-grow text-primary-600 mb-15" role="status"></div>
                <h5 class="fw-bold text-primary-600">Accessing Core Databases...</h5>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Premium Pagination -->
      <div class="d-flex align-items-center justify-content-between p-40 border-top bg-light-50"
        *ngIf="filteredApplications.length > 0">
        <span class="text-secondary-light fw-black small text-uppercase letter-spacing-2">
          Page Record <span class="text-dark">{{ currentPage }}</span> of {{ totalPages }}
        </span>
        <nav>
          <ul class="pagination mb-0 gap-3">
            <li class="page-item" [class.disabled]="currentPage === 1">
              <a class="page-link shadow-lg border-0 radius-16 p-12 transition-all d-flex align-items-center"
                (click)="changePage(currentPage - 1)" href="javascript:void(0)">
                <iconify-icon icon="solar:alt-arrow-left-bold" class="text-xl"></iconify-icon>
              </a>
            </li>

            <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index">
              <a class="page-link shadow-lg border-0 radius-16 py-12 px-20 fw-black transition-all"
                [style.background]="currentPage === i + 1 ? '#800020' : 'white'"
                [style.color]="currentPage === i + 1 ? 'white' : '#1e293b'" (click)="changePage(i + 1)"
                href="javascript:void(0)">
                {{ i + 1 }}
              </a>
            </li>

            <li class="page-item" [class.disabled]="currentPage === totalPages">
              <a class="page-link shadow-lg border-0 radius-16 p-12 transition-all d-flex align-items-center"
                (click)="changePage(currentPage + 1)" href="javascript:void(0)">
                <iconify-icon icon="solar:alt-arrow-right-bold" class="text-xl"></iconify-icon>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>