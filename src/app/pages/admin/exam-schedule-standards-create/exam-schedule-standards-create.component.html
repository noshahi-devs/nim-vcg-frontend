<div class="dashboard-main-body">
  <app-breadcrumb [title]="title"></app-breadcrumb>

  <!-- ===================== MAIN FORM CARD ===================== -->
  <div class="fee-card">
    <div class="fee-card-header">
      <div class="header-left">
        <div>
          <h4 style="margin: 0; font-size: 18px; font-weight: 700; color: #1e293b;">Schedule Configuration</h4>
          <p style="margin: 4px 0 0; font-size: 13px; color: #64748b;">Set up standard level exam dates and timings</p>
        </div>
      </div>
      <div class="d-flex align-items-center gap-2">
        <button class="btn-ghost" routerLink="/exam-schedule-standards-list">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
            style="width: 16px; height: 16px; margin-right: 6px;">
            <path d="M19 12H5M12 19l-7-7 7-7" />
          </svg>
          Back to List
        </button>
        <button class="btn-primary-gradient" (click)="onSubmit()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
            style="width: 18px; height: 18px;">
            <polyline points="20 6 9 17 4 12" />
          </svg>
          Save Schedule
        </button>
      </div>
    </div>

    <div class="fee-card-body p-24">
      <form>
        <!-- Top Section: Core Details -->
        <div class="form-row-2 mb-24">
          <div class="form-card" style="margin-bottom: 0;">
            <div class="form-card-label">
              <span class="card-dot blue"></span>
              Exam Association
            </div>
            <div class="form-group-premium">
              <label class="field-label">Exam Schedule <span class="text-danger">*</span></label>
              <select class="field-input" [(ngModel)]="model.examScheduleId" name="examScheduleId">
                <option [ngValue]="0" disabled selected hidden>Select Exam Schedule</option>
                <option *ngFor="let examSchedule of examScheduleList" [ngValue]="examSchedule.examScheduleId">{{
                  examSchedule.examScheduleName }}</option>
              </select>
            </div>
          </div>

          <div class="form-card" style="margin-bottom: 0;">
            <div class="form-card-label">
              <span class="card-dot indigo"></span>
              Target Standard
            </div>
            <div class="form-group-premium">
              <label class="field-label">Standard <span class="text-danger">*</span></label>
              <select class="field-input" [(ngModel)]="model.standardId" name="standardId">
                <option [ngValue]="0" disabled selected hidden>Select Standard</option>
                <option *ngFor="let standard of standardList" [ngValue]="standard.standardId">{{ standard.standardName
                  }}
                </option>
              </select>
            </div>
          </div>
        </div>

        <!-- Dynamic Subjects Table -->
        <div class="form-card">
          <div class="d-flex align-items-center justify-content-between mb-16">
            <div class="form-card-label" style="margin-bottom: 0;">
              <span class="card-dot green"></span>
              Subject Timings
            </div>
            <button type="button" class="btn-add" style="padding: 8px 16px; font-size: 13px;"
              (click)="addExamSubject()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                style="width: 16px; height: 16px;">
                <path d="M12 5v14M5 12h14" />
              </svg>
              Add Subject
            </button>
          </div>

          <div class="table-wrapper">
            <table class="fee-table">
              <thead>
                <tr>
                  <th style="width: 25%">Subject</th>
                  <th style="width: 20%">Exam Type</th>
                  <th style="width: 20%">Exam Date</th>
                  <th style="width: 15%">Start Time</th>
                  <th style="width: 15%">End Time</th>
                  <th style="width: 5%" class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr class="table-row" *ngFor="let sub of model.examSubjects; let i = index">
                  <td>
                    <select class="field-input accent-blue" style="padding: 8px 12px; height: 38px;"
                      [(ngModel)]="sub.subjectId" name="subject{{i}}">
                      <option [ngValue]="0" disabled selected hidden>Select Subject</option>
                      <option *ngFor="let subject of subjectList" [ngValue]="subject.subjectId">{{ subject.subjectName
                        }}
                        ({{subject.subjectCode}})</option>
                    </select>
                  </td>
                  <td>
                    <select class="field-input accent-indigo" style="padding: 8px 12px; height: 38px;"
                      [(ngModel)]="sub.examTypeId" name="examType{{i}}">
                      <option [ngValue]="0" disabled selected hidden>Select Exam Type</option>
                      <option *ngFor="let type of examTypeList" [ngValue]="type.examTypeId">{{ type.examTypeName }}
                      </option>
                    </select>
                  </td>
                  <td>
                    <input type="date" class="field-input accent-green" style="padding: 8px 12px; height: 38px;"
                      [(ngModel)]="sub.examDate" name="examDate{{i}}">
                  </td>
                  <td>
                    <input type="time" class="field-input" style="padding: 8px 12px; height: 38px;"
                      [(ngModel)]="sub.examStartTime" name="examStartTime{{i}}">
                  </td>
                  <td>
                    <input type="time" class="field-input" style="padding: 8px 12px; height: 38px;"
                      [(ngModel)]="sub.examEndTime" name="examEndTime{{i}}">
                  </td>
                  <td class="text-center">
                    <button type="button" class="icon-btn delete-btn" style="margin: 0 auto; width: 32px; height: 32px;"
                      (click)="deleteExamSubject(i)" title="Remove Row">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        style="width: 16px; height: 16px;">
                        <polyline points="3 6 5 6 21 6" />
                        <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6" />
                        <path d="M10 11v6M14 11v6" />
                      </svg>
                    </button>
                  </td>
                </tr>
                <tr *ngIf="model.examSubjects.length === 0">
                  <td colspan="6" class="empty-state">
                    <p style="margin: 10px 0;">No subjects added. Click "Add Subject" to begin.</p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

      </form>
    </div>
  </div>
</div>